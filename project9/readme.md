# project9： AES / SM4 software implementation
## 实现环境
#### 软件环境：
Visual Studio 2022
#### 硬件环境：
11th Gen Intel(R) Core(TM) i5-11400H @ 2.70GHz   2.69 GHz 16.0 GB (15.6 GB 可用)

## 实现方式
AES算法主要有四种操作处理，分别是密钥加法层(也叫轮密钥加，英文Add Round Key)、字节代换层(SubByte)、行位移层(Shift Rows)、列混淆层(Mix Column)。而明文x和密钥k都是由16个字节组成的数据(当然密钥还支持192位和256位的长度)，它是按照字节的先后顺序从上到下、从左到右进行排列的。而加密出的密文读取顺序也是按照这个顺序读取的，相当于将数组还原成字符串的模样了，然后再解密的时候又是按照4·4数组处理的。AES算法在处理的轮数上只有最后一轮操作与前面的轮处理上有些许不同(最后一轮只是少了列混淆处理)，在轮处理开始前还单独进行了一次轮密钥加的处理。对于128bit分组，重复轮数是10轮。  
#### AES算法流程图：
![image](https://github.com/cscs666/homework_group_81/blob/main/project9/v2-b22e3bdd7da5ddf5ea6ff71909dac4b7_1440w.webp)<br>
#### 密钥加法层
在密钥加法层中有两个输入的参数，分别是明文和子密钥k[0]，而且这两个输入都是128位的。k[0]实际上就等同于密钥k，具体原因在密钥生成中进行介绍。我们前面在介绍扩展域加减法中提到过，在扩展域中加减法操作和异或运算等价，所以这里的处理也就异常的简单了，只需要将两个输入的数据进行按字节异或操作就会得到运算的结果。  
#### 字节代换层
字节代换层的主要功能就是让输入的数据通过S_box表完成从一个字节到另一个字节的映射，这里的S_box表是通过某种方法计算出来的，具体的计算方法将在进阶部分进行介绍，我们基础部分就只给出计算好的S_box结果。S_box表是一个拥有256个字节元素的数组，可以将其定义为一维数组，也可以将其定义为16·16的二维数组，如果将其定义为二维数组，读取S_box数据的方法就是要将输入数据的每个字节的高四位作为第一个下标，第四位作为第二个下标，略有点麻烦。这里建议将其视作一维数组即可。逆S盒与S盒对应，用于解密时对数据处理，我们对解密时的程序处理称作逆字节代换，只是使用的代换表盒加密时不同而已。
S盒：  
![image](https://pic1.zhimg.com/80/v2-e160744c78b680b008c165cb78841858_1440w.webp)<br>
处理流程：
![image](https://pic1.zhimg.com/80/v2-83b41eb29d3e797bafdc4d669365bf5c_1440w.webp)<br>
#### 行位移——ShiftRows
行位移操作最为简单，它是用来将输入数据作为一个4·4的字节矩阵进行处理的，然后将这个矩阵的字节进行位置上的置换。ShiftRows子层属于AES手动的扩散层，目的是将单个位上的变换扩散到影响整个状态当，从而达到雪崩效应。在加密时行位移处理与解密时的处理相反，我们这里将解密时的处理称作逆行位移。它之所以称作行位移，是因为它只在4·4矩阵的行间进行操作，每行4字节的数据。在加密时，保持矩阵的第一行不变，第二行向左移动8Bit(一个字节)、第三行向左移动2个字节、第四行向左移动3个字节。而在解密时恰恰相反，依然保持第一行不变，将第二行向右移动一个字节、第三行右移2个字节、第四行右移3个字节。
![image](https://pic2.zhimg.com/80/v2-581b444c6583aff31afe66b0391d73c1_1440w.webp)<br>
#### 列混合——MixColumns
![image](https://pic3.zhimg.com/80/v2-29de65eb93c100c547f7bd92eb95c9ca_1440w.webp)<br>
#### 密钥生成  
密钥生成大致流程如下：
![image](https://pic4.zhimg.com/80/v2-3027156eb00bcddcdac69657c8aad1e7_1440w.webp)<br>
解密过程与加密过程刚好相反，故不赘述。
## 运行要求
使用Visual Studio直接复制代码并运行。
## 实现效果
加密效果图：

![image](https://github.com/cscs666/homework_group_81/blob/main/project9/\)%5BJ2M\(%5BKP~A~K%60_JWJ%25%25_WL.png)<br>
经过与密码算法库的实现结果进行比较，发现与密码库的加密结果一致，加密算法正确。
